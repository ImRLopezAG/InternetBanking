@using ITBanking.Core.Application.ViewModels
@using ITBanking.Core.Application.Dtos.Account
@using Microsoft.AspNetCore.Http;
@using ITBanking.Core.Application.Helpers;
@inject IHttpContextAccessor _httpContext;
@model IEnumerable<ProductVm>
@{
  AuthenticationResponse? user = _httpContext.HttpContext.Session.Get<AuthenticationResponse>("user");
}

<div class="row">
  <table class="table table-dark table-striped table-hover">
    <thead>
      <tr>
        <th>
          Principal
        </th>
        <th>
          Product
        </th>
        <th>
          @Html.DisplayNameFor(model => model.Type)
        </th>
        <th>
          Amount
        </th>
        @if (user.Roles.Where(x => x.ToString() == "Admin").Any())
        {
          <th>
            Actions
          </th>
          <th>

          </th>
        }
      </tr>
    </thead>
    <tbody>
      @foreach (var item in Model)
      {
        <tr class="@item.IsPrincipal ? " text-success" : "text-danger">
          <td>
            @Html.DisplayFor(modelItem => item.IsPrincipal)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.AccountNumber)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.Type)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.Amount)
          </td>
          @if (user.Roles.Where(x => x.ToString() == "Admin").Any()){
            <td>
              @using (Html.BeginForm("Delete", "Type", FormMethod.Post)){
                <input type="number"  asp-for="@item.Amount"  />
                <input type="submit" class="btn btn-danger" value="Delete"
            onclick="return confirm('are you sure that you want delete this Type : @item.AccountNumber')">
              }
            </td>
          }
        </tr>
      }
    </tbody>
  </table>
</div>